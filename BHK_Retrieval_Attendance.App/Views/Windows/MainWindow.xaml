<Window x:Class="BHK.Retrieval.Attendance.WPF.Views.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        Title="BHK Retrieval Attendance System" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">

    <Window.Resources>
        <Style x:Key="MenuButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignFlatButton}">
            <Setter Property="Height" Value="50"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <materialDesign:ColorZone Grid.Row="0" 
                                  Mode="PrimaryDark" 
                                  Padding="16">
            <DockPanel>
                <Button DockPanel.Dock="Left"
                        Style="{StaticResource MaterialDesignIconButton}"
                        Command="{Binding ToggleMenuCommand}">
                    <materialDesign:PackIcon Kind="Menu" />
                </Button>
                
                <TextBlock DockPanel.Dock="Left"
                           Text="BHK Retrieval Attendance System"
                           FontSize="20"
                           FontWeight="Medium"
                           Margin="10,0"
                           VerticalAlignment="Center"/>

                <Button DockPanel.Dock="Right"
                        Style="{StaticResource MaterialDesignIconButton}"
                        Command="{Binding ExitApplicationCommand}">
                    <materialDesign:PackIcon Kind="Close" />
                </Button>

                <TextBlock DockPanel.Dock="Right"
                           Text="{Binding CurrentUser, StringFormat='Xin chào: {0}'}"
                           FontSize="14"
                           Margin="10,0"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Right"/>
            </DockPanel>
        </materialDesign:ColorZone>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Navigation Menu -->
            <materialDesign:Card Grid.Column="0" 
                                Margin="8,8,4,8"
                                Visibility="{Binding IsMenuVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Width="250">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="8">
                        <TextBlock Text="Menu"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Margin="16,8"/>

                        <Separator Margin="8"/>

                        <Button Style="{StaticResource MenuButtonStyle}"
                                Command="{Binding NavigateToDeviceConnectionCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="DevicesOther" 
                                                        VerticalAlignment="Center"
                                                        Margin="0,0,10,0"/>
                                <TextBlock Text="Kết nối thiết bị" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <Button Style="{StaticResource MenuButtonStyle}"
                                Command="{Binding NavigateToLoginCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Login" 
                                                        VerticalAlignment="Center"
                                                        Margin="0,0,10,0"/>
                                <TextBlock Text="Đăng nhập Demo" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <Separator Margin="8"/>

                        <Button Style="{StaticResource MenuButtonStyle}"
                                Command="{Binding NavigateToEmployeeSelectionCommand}"
                                IsEnabled="{Binding IsLoggedIn}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="AccountGroup" 
                                                        VerticalAlignment="Center"
                                                        Margin="0,0,10,0"/>
                                <TextBlock Text="Chọn nhân viên" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </materialDesign:Card>

            <!-- Content Area -->
            <materialDesign:Card Grid.Column="1" 
                                Margin="4,8,8,8">
                <ContentControl Content="{Binding CurrentView}"/>
            </materialDesign:Card>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>

            <StatusBarItem Grid.Column="0">
                <TextBlock Text="{Binding StatusMessage}"/>
            </StatusBarItem>

            <StatusBarItem Grid.Column="1">
                <StackPanel Orientation="Horizontal">
                    <Ellipse Width="10" Height="10" 
                             Fill="{Binding DeviceConnectionStatus, Converter={StaticResource ConnectionStatusToColorConverter}}"
                             Margin="5,0"/>
                    <TextBlock Text="{Binding DeviceConnectionText}"/>
                </StackPanel>
            </StatusBarItem>

            <StatusBarItem Grid.Column="2">
                <TextBlock Text="{Binding CurrentTime, StringFormat='HH:mm:ss dd/MM/yyyy'}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>